syntax = "proto3";

package emailservice;

service Email {
    rpc sendAcesssEmail(AccessEmailRequest) returns (emailServiceResponse);
    rpc sendVerificationEmail(VerificationEmailRequest) returns (emailServiceResponse);
    rpc sendReports(Reports) returns (emailServiceResponse);
  }

message VerificationEmailRequest {
  string to = 1;          
  string subject = 2;      
  VerificationEmailData data = 3;     
  int32 retry = 4;       
}
message Reports{
  repeated ReportData data =3;
}

message ReportData {
  string to =1;
  string subject = 2;
  string month = 3;
  int32 total_clicks = 4;
  int32 total_qr_scans = 5;
  int32 new_links = 6;
  repeated TopLink top_links = 7;
  repeated TopQRCode top_qr_codes = 8;
  repeated Country countries = 9;
  OtherCountries other_countries = 10;
  int32 year = 11;
  string created_at = 12;
  int32 retry = 13;   
}

message TopLink {
  string title = 1;
  string url = 2;
  string short_url = 3;
  int32 clicks = 4;
  string created_on = 5; // ISO date string
}

// Top QR code message
message TopQRCode {
  string name = 1;
  string url = 2;
  string short_url = 3;
  int32 scans = 4;
  string created_on = 5; // ISO date string
}

// Country traffic message
message Country {
  int32 rank = 1;
  string flag = 2;   // can be emoji or image URL
  string name = 3;
  int32 clicks = 4;
  int32 qr_scans = 5;
}

// Other countries aggregated stats
message OtherCountries {
  int32 clicks = 1;
  int32 qr_scans = 2;
}


message VerificationEmailData {
  string name = 1;         
  string verifyUrl = 2;    
  int32 expiryHours = 3;    
  string year = 4;         
}

message emailServiceResponse {
  string msg = 1;  
       
}


message AccessEmailRequest {
    string to = 1;          
    string subject = 2;      
    AccessEmailData data = 3;     
    int32 retry = 4;       
  }

  
message AccessEmailData {
 string name = 1;
 string location =2 ;
 string ipAddress =3 ;
 string dateTime =4;
 string secureAccountUrl = 5;
 string year =6;

}